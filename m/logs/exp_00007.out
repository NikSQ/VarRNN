

config:

HOME=/clusterFS/home/student/kopp13
PATH=/clusterFS/home/student/kopp13/miniconda3/envs/tensorflow/bin:/clusterFS/home/student/kopp13/miniconda3/condabin:/clusterFS/home/student/kopp13/VarRNN/src/bin:/clusterFS/home/student/kopp13/miniconda3/bin:/clusterFS/home/student/kopp13/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
LD_LIBRARY_PATH=:/usr/local/cuda-9.0/lib64
THEANO_FLAGS=floatX=float32,gpuarray.preallocate=0.9,dnn.library_path=/usr/lib/x86_64-linux-gnu,cxx=clang++-3.8,device=cuda,base_compiledir=/tmp/tmp.LYcFC069UW


=============================
CONFIG FILE

TRAINING CONFIG
{'algorithm': ['l_reparam', 'ste'],
 'batchnorm': {'modes': [], 'momentum': 0.98, 'tau': 1, 'type': 'none'},
 'carm_iterations': 10,
 'dir_reg': 0.0,
 'ent_reg': 0.0,
 'learning_rate': 0.01,
 'learning_rate_tau': 19000,
 'mode': {'max_epochs': 1000, 'min_error': 0.0, 'name': 'classic'},
 'pretraining': {'enabled': False, 'path': 'm_model', 'sec_path': 'm_ter'},
 'task_id': 7,
 'tau': 1.5,
 'var_reg': 0.0}

DATA CONFIG
{'dataset': 'penstroke',
 'remove_bias': True,
 'te': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': False,
        'minibatch_size': 1000},
 'tr': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': False,
        'minibatch_size': 1000},
 'va': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': False,
        'minibatch_size': 1000}}

RNN CONFIG
{'act_bins': 2.0,
 'act_disc': ['i', 'c', 'o'],
 'architecture': 'casual',
 'data_multiplier': None,
 'gradient_clip_value': 0.5,
 'layer_configs': [{'layer_type': 'input'},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bias_enabled': True,
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': ['i', 'c', 'o'],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 1.5,
                    'var_scope': 'lstm_0',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bias_enabled': True,
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': ['i', 'c', 'o'],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 1.5,
                    'var_scope': 'lstm_1',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'b': {'init_m': 'zeros',
                          'init_v': -4.5,
                          'prior_m': 0.0,
                          'prior_v': 0.0,
                          'type': 'continuous'},
                    'bias_enabled': True,
                    'layer_type': 'fc',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'regularization': {'mode': None, 'strength': 0.02},
                    'tau': 1.5,
                    'var_scope': 'output_layer',
                    'w': {'p0max': 0.95,
                          'p0min': 0.05,
                          'parametrization': 'sigmoid',
                          'pmax': 0.99,
                          'pmin': 0.01,
                          'priors': [0.1, 0.8, 0.1],
                          'type': 'ternary'}}],
 'layout': [4, 40, 40, 10],
 'output_type': 'classification'}
==============================


tr
(9940, 4, 40)
va
(2120, 4, 40)
te
(1780, 4, 40)
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
(None, <tf.Variable 'lstm_0/wi:0' shape=(44, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1022:0' shape=(44, 40) dtype=float32>, <tf.Variable 'lstm_0/wi_sa:0' shape=(44, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1021:0' shape=(44, 40) dtype=float32>, <tf.Variable 'lstm_0/wi_sb:0' shape=(44, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_0/bi:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1007:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_0/bi_m:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/lstm_0/Exp_grad/mul:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_0/bi_v:0' shape=(1, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_0/wc:0' shape=(44, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1017:0' shape=(44, 40) dtype=float32>, <tf.Variable 'lstm_0/wc_sa:0' shape=(44, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1016:0' shape=(44, 40) dtype=float32>, <tf.Variable 'lstm_0/wc_sb:0' shape=(44, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_0/bc:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1005:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_0/bc_m:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/lstm_0/Exp_1_grad/mul:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_0/bc_v:0' shape=(1, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_0/wo:0' shape=(44, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1019:0' shape=(44, 40) dtype=float32>, <tf.Variable 'lstm_0/wo_sa:0' shape=(44, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1018:0' shape=(44, 40) dtype=float32>, <tf.Variable 'lstm_0/wo_sb:0' shape=(44, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_0/bo:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1006:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_0/bo_m:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/lstm_0/Exp_2_grad/mul:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_0/bo_v:0' shape=(1, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_1/wi:0' shape=(80, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1001:0' shape=(80, 40) dtype=float32>, <tf.Variable 'lstm_1/wi_sa:0' shape=(80, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_1000:0' shape=(80, 40) dtype=float32>, <tf.Variable 'lstm_1/wi_sb:0' shape=(80, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_1/bi:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_975:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_1/bi_m:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/lstm_1/Exp_grad/mul:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_1/bi_v:0' shape=(1, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_1/wc:0' shape=(80, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_994:0' shape=(80, 40) dtype=float32>, <tf.Variable 'lstm_1/wc_sa:0' shape=(80, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_993:0' shape=(80, 40) dtype=float32>, <tf.Variable 'lstm_1/wc_sb:0' shape=(80, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_1/bc:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_973:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_1/bc_m:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/lstm_1/Exp_1_grad/mul:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_1/bc_v:0' shape=(1, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_1/wo:0' shape=(80, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_996:0' shape=(80, 40) dtype=float32>, <tf.Variable 'lstm_1/wo_sa:0' shape=(80, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_995:0' shape=(80, 40) dtype=float32>, <tf.Variable 'lstm_1/wo_sb:0' shape=(80, 40) dtype=float32_ref>)
(None, <tf.Variable 'lstm_1/bo:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/AddN_974:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_1/bo_m:0' shape=(1, 40) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/lstm_1/Exp_2_grad/mul:0' shape=(1, 40) dtype=float32>, <tf.Variable 'lstm_1/bo_v:0' shape=(1, 40) dtype=float32_ref>)
(None, <tf.Variable 'output_layer/w:0' shape=(40, 10) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/tr_b/Sigmoid_279_grad/SigmoidGrad:0' shape=(40, 10) dtype=float32>, <tf.Variable 'output_layer/w_sa:0' shape=(40, 10) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/tr_b/truediv_919_grad/Reshape:0' shape=(40, 10) dtype=float32>, <tf.Variable 'output_layer/w_sb:0' shape=(40, 10) dtype=float32_ref>)
(None, <tf.Variable 'output_layer/b:0' shape=(1, 10) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/tr_b/add_3076_grad/Reshape_1:0' shape=(1, 10) dtype=float32>, <tf.Variable 'output_layer/b_m:0' shape=(1, 10) dtype=float32_ref>)
(<tf.Tensor 'tr_b/gradients/output_layer/Exp_grad/mul:0' shape=(1, 10) dtype=float32>, <tf.Variable 'output_layer/b_v:0' shape=(1, 10) dtype=float32_ref>)
