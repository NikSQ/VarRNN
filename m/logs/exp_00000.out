

config:

HOME=/clusterFS/home/student/kopp13
PATH=/clusterFS/home/student/kopp13/miniconda3/envs/tensorflow/bin:/clusterFS/home/student/kopp13/miniconda3/condabin:/clusterFS/home/student/kopp13/VarRNN/src/bin:/clusterFS/home/student/kopp13/miniconda3/bin:/clusterFS/home/student/kopp13/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
LD_LIBRARY_PATH=:/usr/local/cuda-9.0/lib64
THEANO_FLAGS=floatX=float32,gpuarray.preallocate=0.9,dnn.library_path=/usr/lib/x86_64-linux-gnu,cxx=clang++-3.8,device=cuda,base_compiledir=/tmp/tmp.eNkiIUVsls


=============================
CONFIG FILE

TRAINING CONFIG
{'algorithm': ['l_reparam', 'ste'],
 'batchnorm': {'modes': [], 'momentum': 0.98, 'tau': 1, 'type': 'none'},
 'carm_iterations': 10,
 'dir_reg': 0.0,
 'ent_reg': 0.0,
 'learning_rate': 0.3,
 'learning_rate_tau': 4000,
 'mode': {'max_epochs': 5, 'min_error': 0.0, 'name': 'classic'},
 'pretraining': {'enabled': True, 'path': 'prob_m_ter0', 'sec_path': 'm_bin'},
 'task_id': 0,
 'tau': 0.5,
 'var_reg': 0.0}

DATA CONFIG
{'dataset': 'penstroke',
 'remove_bias': True,
 'te': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'tr': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'va': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000}}

RNN CONFIG
{'act_disc': [],
 'data_multiplier': None,
 'gradient_clip_value': 0.5,
 'layer_configs': [{'layer_type': 'input'},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_0',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_1',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'b': {'init_m': 'zeros',
                          'init_v': -4.5,
                          'prior_m': 0.0,
                          'prior_v': 0.0,
                          'type': 'continuous'},
                    'layer_type': 'fc',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'regularization': {'mode': None, 'strength': 0.02},
                    'tau': 0.5,
                    'var_scope': 'output_layer',
                    'w': {'p0max': 0.95,
                          'p0min': 0.05,
                          'parametrization': 'sigmoid',
                          'pmax': 0.99,
                          'pmin': 0.01,
                          'priors': [0.1, 0.8, 0.1],
                          'type': 'ternary'}}],
 'layout': [4, 40, 40, 10],
 'output_type': 'classification'}
==============================


tr
(9940, 4, 40)
va
(2120, 4, 40)
te
(1780, 4, 40)
(1780, 4, 40)
(1780, 10)
(9940, 4, 40)
(9940, 10)
(2120, 4, 40)
(2120, 10)
  0,  0 | TrAcc: 0.9930, TrLoss:  0.02886, VaAcc: 0.9417, VaLoss:  0.22222	 MAP NN | Acc: 0.9510 | Loss: 0.2113
  1,  0 | TrAcc: 0.9113, TrLoss:  0.30177, VaAcc: 0.9043, VaLoss:  0.34160	 MAP NN | Acc: 0.9200 | Loss: 0.3007
  2,  0 | TrAcc: 0.9450, TrLoss:  0.17211, VaAcc: 0.9157, VaLoss:  0.28786	 MAP NN | Acc: 0.9287 | Loss: 0.2676
  3,  0 | TrAcc: 0.9562, TrLoss:  0.13452, VaAcc: 0.9327, VaLoss:  0.23810	 MAP NN | Acc: 0.9387 | Loss: 0.2252
  4,  0 | TrAcc: 0.9698, TrLoss:  0.10826, VaAcc: 0.9303, VaLoss:  0.23813	 MAP NN | Acc: 0.9377 | Loss: 0.2153

=============================
CONFIG FILE

TRAINING CONFIG
{'algorithm': ['l_reparam', 'ste'],
 'batchnorm': {'modes': [], 'momentum': 0.98, 'tau': 1, 'type': 'none'},
 'carm_iterations': 10,
 'dir_reg': 0.0,
 'ent_reg': 0.0,
 'learning_rate': 0.3,
 'learning_rate_tau': 4000,
 'mode': {'max_epochs': 5, 'min_error': 0.0, 'name': 'classic'},
 'pretraining': {'enabled': True, 'path': 'prob_m_ter1', 'sec_path': 'm_bin'},
 'task_id': 0,
 'tau': 0.5,
 'var_reg': 0.0}

DATA CONFIG
{'dataset': 'penstroke',
 'remove_bias': True,
 'te': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'tr': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'va': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000}}

RNN CONFIG
{'act_disc': [],
 'data_multiplier': None,
 'gradient_clip_value': 0.5,
 'layer_configs': [{'layer_type': 'input'},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_0',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_1',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'b': {'init_m': 'zeros',
                          'init_v': -4.5,
                          'prior_m': 0.0,
                          'prior_v': 0.0,
                          'type': 'continuous'},
                    'layer_type': 'fc',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'regularization': {'mode': None, 'strength': 0.02},
                    'tau': 0.5,
                    'var_scope': 'output_layer',
                    'w': {'p0max': 0.95,
                          'p0min': 0.05,
                          'parametrization': 'sigmoid',
                          'pmax': 0.99,
                          'pmin': 0.01,
                          'priors': [0.1, 0.8, 0.1],
                          'type': 'ternary'}}],
 'layout': [4, 40, 40, 10],
 'output_type': 'classification'}
==============================


tr
(9940, 4, 40)
va
(2120, 4, 40)
te
(1780, 4, 40)
(1780, 4, 40)
(1780, 10)
(9940, 4, 40)
(9940, 10)
(2120, 4, 40)
(2120, 10)
  0,  0 | TrAcc: 0.9933, TrLoss:  0.02489, VaAcc: 0.9390, VaLoss:  0.24201	 MAP NN | Acc: 0.9480 | Loss: 0.2030
  1,  0 | TrAcc: 0.9256, TrLoss:  0.23550, VaAcc: 0.9137, VaLoss:  0.32452	 MAP NN | Acc: 0.9320 | Loss: 0.2771
  2,  0 | TrAcc: 0.9479, TrLoss:  0.18136, VaAcc: 0.9260, VaLoss:  0.28315	 MAP NN | Acc: 0.9270 | Loss: 0.2538
  3,  0 | TrAcc: 0.9648, TrLoss:  0.12281, VaAcc: 0.9313, VaLoss:  0.26391	 MAP NN | Acc: 0.9307 | Loss: 0.2698
  4,  0 | TrAcc: 0.9733, TrLoss:  0.09438, VaAcc: 0.9410, VaLoss:  0.23248	 MAP NN | Acc: 0.9440 | Loss: 0.2252

=============================
CONFIG FILE

TRAINING CONFIG
{'algorithm': ['l_reparam', 'ste'],
 'batchnorm': {'modes': [], 'momentum': 0.98, 'tau': 1, 'type': 'none'},
 'carm_iterations': 10,
 'dir_reg': 0.0,
 'ent_reg': 0.0,
 'learning_rate': 0.3,
 'learning_rate_tau': 4000,
 'mode': {'max_epochs': 5, 'min_error': 0.0, 'name': 'classic'},
 'pretraining': {'enabled': True, 'path': 'prob_m_ter2', 'sec_path': 'm_bin'},
 'task_id': 0,
 'tau': 0.5,
 'var_reg': 0.0}

DATA CONFIG
{'dataset': 'penstroke',
 'remove_bias': True,
 'te': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'tr': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'va': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000}}

RNN CONFIG
{'act_disc': [],
 'data_multiplier': None,
 'gradient_clip_value': 0.5,
 'layer_configs': [{'layer_type': 'input'},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_0',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_1',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'b': {'init_m': 'zeros',
                          'init_v': -4.5,
                          'prior_m': 0.0,
                          'prior_v': 0.0,
                          'type': 'continuous'},
                    'layer_type': 'fc',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'regularization': {'mode': None, 'strength': 0.02},
                    'tau': 0.5,
                    'var_scope': 'output_layer',
                    'w': {'p0max': 0.95,
                          'p0min': 0.05,
                          'parametrization': 'sigmoid',
                          'pmax': 0.99,
                          'pmin': 0.01,
                          'priors': [0.1, 0.8, 0.1],
                          'type': 'ternary'}}],
 'layout': [4, 40, 40, 10],
 'output_type': 'classification'}
==============================


tr
(9940, 4, 40)
va
(2120, 4, 40)
te
(1780, 4, 40)
(1780, 4, 40)
(1780, 10)
(9940, 4, 40)
(9940, 10)
(2120, 4, 40)
(2120, 10)
  0,  0 | TrAcc: 0.9946, TrLoss:  0.02845, VaAcc: 0.9377, VaLoss:  0.22791	 MAP NN | Acc: 0.9490 | Loss: 0.1871
  1,  0 | TrAcc: 0.8339, TrLoss:  0.55773, VaAcc: 0.8420, VaLoss:  0.55846	 MAP NN | Acc: 0.8850 | Loss: 0.4570
  2,  0 | TrAcc: 0.9051, TrLoss:  0.29926, VaAcc: 0.8883, VaLoss:  0.40389	 MAP NN | Acc: 0.8980 | Loss: 0.3929
  3,  0 | TrAcc: 0.9256, TrLoss:  0.24767, VaAcc: 0.9103, VaLoss:  0.34834	 MAP NN | Acc: 0.9130 | Loss: 0.3289
  4,  0 | TrAcc: 0.9516, TrLoss:  0.16082, VaAcc: 0.9240, VaLoss:  0.31157	 MAP NN | Acc: 0.9280 | Loss: 0.3092

=============================
CONFIG FILE

TRAINING CONFIG
{'algorithm': ['l_reparam', 'ste'],
 'batchnorm': {'modes': [], 'momentum': 0.98, 'tau': 1, 'type': 'none'},
 'carm_iterations': 10,
 'dir_reg': 0.0,
 'ent_reg': 0.0,
 'learning_rate': 0.3,
 'learning_rate_tau': 4000,
 'mode': {'max_epochs': 5, 'min_error': 0.0, 'name': 'classic'},
 'pretraining': {'enabled': True, 'path': 'prob_m_ter3', 'sec_path': 'm_bin'},
 'task_id': 0,
 'tau': 0.5,
 'var_reg': 0.0}

DATA CONFIG
{'dataset': 'penstroke',
 'remove_bias': True,
 'te': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'tr': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'va': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000}}

RNN CONFIG
{'act_disc': [],
 'data_multiplier': None,
 'gradient_clip_value': 0.5,
 'layer_configs': [{'layer_type': 'input'},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_0',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_1',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'b': {'init_m': 'zeros',
                          'init_v': -4.5,
                          'prior_m': 0.0,
                          'prior_v': 0.0,
                          'type': 'continuous'},
                    'layer_type': 'fc',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'regularization': {'mode': None, 'strength': 0.02},
                    'tau': 0.5,
                    'var_scope': 'output_layer',
                    'w': {'p0max': 0.95,
                          'p0min': 0.05,
                          'parametrization': 'sigmoid',
                          'pmax': 0.99,
                          'pmin': 0.01,
                          'priors': [0.1, 0.8, 0.1],
                          'type': 'ternary'}}],
 'layout': [4, 40, 40, 10],
 'output_type': 'classification'}
==============================


tr
(9940, 4, 40)
va
(2120, 4, 40)
te
(1780, 4, 40)
(1780, 4, 40)
(1780, 10)
(9940, 4, 40)
(9940, 10)
(2120, 4, 40)
(2120, 10)
  0,  0 | TrAcc: 0.9946, TrLoss:  0.02274, VaAcc: 0.9313, VaLoss:  0.24778	 MAP NN | Acc: 0.9450 | Loss: 0.2116
  1,  0 | TrAcc: 0.9472, TrLoss:  0.18550, VaAcc: 0.9137, VaLoss:  0.33247	 MAP NN | Acc: 0.9250 | Loss: 0.3056
  2,  0 | TrAcc: 0.9610, TrLoss:  0.13347, VaAcc: 0.9310, VaLoss:  0.27268	 MAP NN | Acc: 0.9380 | Loss: 0.2586
  3,  0 | TrAcc: 0.9712, TrLoss:  0.10289, VaAcc: 0.9327, VaLoss:  0.24361	 MAP NN | Acc: 0.9250 | Loss: 0.2669
  4,  0 | TrAcc: 0.9792, TrLoss:  0.07300, VaAcc: 0.9350, VaLoss:  0.23622	 MAP NN | Acc: 0.9350 | Loss: 0.2257

=============================
CONFIG FILE

TRAINING CONFIG
{'algorithm': ['l_reparam', 'ste'],
 'batchnorm': {'modes': [], 'momentum': 0.98, 'tau': 1, 'type': 'none'},
 'carm_iterations': 10,
 'dir_reg': 0.0,
 'ent_reg': 0.0,
 'learning_rate': 0.3,
 'learning_rate_tau': 4000,
 'mode': {'max_epochs': 5, 'min_error': 0.0, 'name': 'classic'},
 'pretraining': {'enabled': True, 'path': 'prob_m_ter4', 'sec_path': 'm_bin'},
 'task_id': 0,
 'tau': 0.5,
 'var_reg': 0.0}

DATA CONFIG
{'dataset': 'penstroke',
 'remove_bias': True,
 'te': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'tr': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'va': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000}}

RNN CONFIG
{'act_disc': [],
 'data_multiplier': None,
 'gradient_clip_value': 0.5,
 'layer_configs': [{'layer_type': 'input'},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_0',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 0.5,
                    'var_scope': 'lstm_1',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'ternary'}},
                   {'b': {'init_m': 'zeros',
                          'init_v': -4.5,
                          'prior_m': 0.0,
                          'prior_v': 0.0,
                          'type': 'continuous'},
                    'layer_type': 'fc',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'regularization': {'mode': None, 'strength': 0.02},
                    'tau': 0.5,
                    'var_scope': 'output_layer',
                    'w': {'p0max': 0.95,
                          'p0min': 0.05,
                          'parametrization': 'sigmoid',
                          'pmax': 0.99,
                          'pmin': 0.01,
                          'priors': [0.1, 0.8, 0.1],
                          'type': 'ternary'}}],
 'layout': [4, 40, 40, 10],
 'output_type': 'classification'}
==============================


tr
(9940, 4, 40)
va
(2120, 4, 40)
te
(1780, 4, 40)
(1780, 4, 40)
(1780, 10)
(9940, 4, 40)
(9940, 10)
(2120, 4, 40)
(2120, 10)
