

config:

HOME=/clusterFS/home/student/kopp13
PATH=/clusterFS/home/student/kopp13/miniconda3/envs/tensorflow/bin:/clusterFS/home/student/kopp13/miniconda3/condabin:/clusterFS/home/student/kopp13/VarRNN/src/bin:/clusterFS/home/student/kopp13/miniconda3/bin:/clusterFS/home/student/kopp13/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
LD_LIBRARY_PATH=:/usr/local/cuda-9.0/lib64
THEANO_FLAGS=floatX=float32,gpuarray.preallocate=0.9,dnn.library_path=/usr/lib/x86_64-linux-gnu,cxx=clang++-3.8,device=cuda,base_compiledir=/tmp/tmp.KFM6eD4uba

what

=============================
CONFIG FILE

TRAINING CONFIG
{'algorithm': 'c_ar',
 'batchnorm': {'modes': [], 'momentum': 0.98, 'tau': 1, 'type': 'none'},
 'carm_iterations': 500,
 'dir_reg': 0.0,
 'ent_reg': 0.0,
 'learning_rate': 0.002,
 'learning_rate_tau': inf,
 'mode': {'max_epochs': 100, 'min_error': 0.0, 'name': 'classic'},
 'pretraining': {'enabled': True, 'path': 'm_model'},
 'task_id': 4,
 'tau': 1.0,
 'var_reg': 0.0}

DATA CONFIG
{'dataset': 'penstroke',
 'remove_bias': True,
 'te': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 500},
 'tr': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 1000},
 'va': {'in_seq_len': 40,
        'max_truncation': 5,
        'minibatch_enabled': True,
        'minibatch_size': 500}}

RNN CONFIG
{'act_disc': [],
 'data_multiplier': None,
 'gradient_clip_value': 0.5,
 'layer_configs': [{'layer_type': 'input'},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 1.0,
                    'var_scope': 'lstm_0',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'binary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'binary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'binary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'binary'}},
                   {'bc': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bf': {'init_m': 'ones',
                           'init_v': -4.5,
                           'prior_m': 1.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bi': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'bo': {'init_m': 'zeros',
                           'init_v': -4.5,
                           'prior_m': 0.0,
                           'prior_v': 0.0,
                           'type': 'continuous'},
                    'discrete_act': [],
                    'layer_type': 'lstm',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'tau': 1.0,
                    'var_scope': 'lstm_1',
                    'wc': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'binary'},
                    'wf': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'binary'},
                    'wi': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'binary'},
                    'wo': {'p0max': 0.95,
                           'p0min': 0.05,
                           'parametrization': 'sigmoid',
                           'pmax': 0.99,
                           'pmin': 0.01,
                           'priors': [0.1, 0.8, 0.1],
                           'type': 'binary'}},
                   {'b': {'init_m': 'zeros',
                          'init_v': -4.5,
                          'prior_m': 0.0,
                          'prior_v': 0.0,
                          'type': 'continuous'},
                    'layer_type': 'fc',
                    'lr_adapt': False,
                    'parametrization': 'sigmoid',
                    'regularization': {'mode': None, 'strength': 0.02},
                    'tau': 1.0,
                    'var_scope': 'output_layer',
                    'w': {'p0max': 0.95,
                          'p0min': 0.05,
                          'parametrization': 'sigmoid',
                          'pmax': 0.99,
                          'pmin': 0.01,
                          'priors': [0.1, 0.8, 0.1],
                          'type': 'binary'}}],
 'layout': [4, 40, 40, 10],
 'output_type': 'classification'}
==============================


tr
(9940, 4, 40)
va
(2120, 4, 40)
te
(1780, 4, 40)
  0,  0 | VaAcc: 0.1108, VaLoss:  4.83854	 MAP NN | Acc: 0.1276 | Loss: 5.2944
  1,  0 | VaAcc: 0.1436, VaLoss:  4.52397	 MAP NN | Acc: 0.1240 | Loss: 5.1809
  2,  0 | VaAcc: 0.1216, VaLoss:  4.68769	 MAP NN | Acc: 0.1536 | Loss: 4.9364
  3,  0 | VaAcc: 0.1144, VaLoss:  4.72254	 MAP NN | Acc: 0.1368 | Loss: 4.9630
  4,  0 | VaAcc: 0.1228, VaLoss:  4.63140	 MAP NN | Acc: 0.1292 | Loss: 4.7921
  5,  0 | VaAcc: 0.1264, VaLoss:  4.75844	 MAP NN | Acc: 0.1324 | Loss: 4.8768
  6,  0 | VaAcc: 0.1048, VaLoss:  4.98658	 MAP NN | Acc: 0.1504 | Loss: 5.0739
  7,  0 | VaAcc: 0.1060, VaLoss:  4.92156	 MAP NN | Acc: 0.1136 | Loss: 5.2126
  8,  0 | VaAcc: 0.0992, VaLoss:  4.72069	 MAP NN | Acc: 0.1304 | Loss: 5.2526
  9,  0 | VaAcc: 0.1236, VaLoss:  4.91138	 MAP NN | Acc: 0.1328 | Loss: 5.2720
 10,  0 | VaAcc: 0.1128, VaLoss:  4.85956	 MAP NN | Acc: 0.1380 | Loss: 5.1449
 11,  0 | VaAcc: 0.1104, VaLoss:  4.85638	 MAP NN | Acc: 0.1344 | Loss: 5.3564
 12,  0 | VaAcc: 0.1092, VaLoss:  4.88247	 MAP NN | Acc: 0.1136 | Loss: 5.2864
 13,  0 | VaAcc: 0.1104, VaLoss:  4.92714	 MAP NN | Acc: 0.1184 | Loss: 5.3663
 14,  0 | VaAcc: 0.1204, VaLoss:  4.89581	 MAP NN | Acc: 0.1244 | Loss: 5.0433
 15,  0 | VaAcc: 0.1036, VaLoss:  5.40105	 MAP NN | Acc: 0.1200 | Loss: 5.0606
 16,  0 | VaAcc: 0.1124, VaLoss:  4.54953	 MAP NN | Acc: 0.1376 | Loss: 5.1216
 17,  0 | VaAcc: 0.1032, VaLoss:  5.07085	 MAP NN | Acc: 0.1460 | Loss: 5.2097
 18,  0 | VaAcc: 0.1132, VaLoss:  4.81489	 MAP NN | Acc: 0.1460 | Loss: 5.0037
 19,  0 | VaAcc: 0.1136, VaLoss:  4.85849	 MAP NN | Acc: 0.1528 | Loss: 4.9176
 20,  0 | VaAcc: 0.1040, VaLoss:  4.87465	 MAP NN | Acc: 0.1584 | Loss: 4.8565
 21,  0 | VaAcc: 0.1092, VaLoss:  5.06365	 MAP NN | Acc: 0.1496 | Loss: 4.9788
 22,  0 | VaAcc: 0.1244, VaLoss:  4.68115	 MAP NN | Acc: 0.1320 | Loss: 5.1688
 23,  0 | VaAcc: 0.1068, VaLoss:  4.75393	 MAP NN | Acc: 0.1696 | Loss: 4.6902
 24,  0 | VaAcc: 0.0972, VaLoss:  5.22769	 MAP NN | Acc: 0.1472 | Loss: 4.8739
 25,  0 | VaAcc: 0.1112, VaLoss:  4.87034	 MAP NN | Acc: 0.1540 | Loss: 4.8121
 26,  0 | VaAcc: 0.1096, VaLoss:  4.95965	 MAP NN | Acc: 0.1416 | Loss: 5.0862
 27,  0 | VaAcc: 0.1068, VaLoss:  4.87876	 MAP NN | Acc: 0.1440 | Loss: 4.9771
 28,  0 | VaAcc: 0.1196, VaLoss:  4.82098	 MAP NN | Acc: 0.1360 | Loss: 4.9843
 29,  0 | VaAcc: 0.1196, VaLoss:  4.64805	 MAP NN | Acc: 0.1380 | Loss: 4.7124
 30,  0 | VaAcc: 0.1108, VaLoss:  4.82811	 MAP NN | Acc: 0.1468 | Loss: 4.6376
 31,  0 | VaAcc: 0.1144, VaLoss:  4.83360	 MAP NN | Acc: 0.1552 | Loss: 4.7315
 32,  0 | VaAcc: 0.1072, VaLoss:  4.69745	 MAP NN | Acc: 0.1500 | Loss: 4.7753
 33,  0 | VaAcc: 0.1000, VaLoss:  4.78970	 MAP NN | Acc: 0.1200 | Loss: 5.0299
 34,  0 | VaAcc: 0.1152, VaLoss:  4.75908	 MAP NN | Acc: 0.1608 | Loss: 4.5778
 35,  0 | VaAcc: 0.1192, VaLoss:  4.78613	 MAP NN | Acc: 0.1780 | Loss: 4.5013
 36,  0 | VaAcc: 0.1156, VaLoss:  5.11266	 MAP NN | Acc: 0.1340 | Loss: 4.7331
 37,  0 | VaAcc: 0.1068, VaLoss:  4.91677	 MAP NN | Acc: 0.1380 | Loss: 4.7777
 38,  0 | VaAcc: 0.1144, VaLoss:  4.82809	 MAP NN | Acc: 0.1580 | Loss: 4.5615
 39,  0 | VaAcc: 0.1152, VaLoss:  4.98581	 MAP NN | Acc: 0.1460 | Loss: 4.6250
 40,  0 | VaAcc: 0.1064, VaLoss:  4.76108	 MAP NN | Acc: 0.1460 | Loss: 4.4672
 41,  0 | VaAcc: 0.1000, VaLoss:  4.81764	 MAP NN | Acc: 0.1700 | Loss: 4.6421
 42,  0 | VaAcc: 0.0960, VaLoss:  5.00831	 MAP NN | Acc: 0.1420 | Loss: 4.7387
 43,  0 | VaAcc: 0.1296, VaLoss:  4.86426	 MAP NN | Acc: 0.1340 | Loss: 4.7729
 44,  0 | VaAcc: 0.1188, VaLoss:  4.85877	 MAP NN | Acc: 0.1420 | Loss: 4.5484
 45,  0 | VaAcc: 0.0960, VaLoss:  5.07494	 MAP NN | Acc: 0.1548 | Loss: 4.4001
 46,  0 | VaAcc: 0.1276, VaLoss:  4.71676	 MAP NN | Acc: 0.1768 | Loss: 4.3860
 47,  0 | VaAcc: 0.1352, VaLoss:  4.73413	 MAP NN | Acc: 0.1624 | Loss: 4.5524
 48,  0 | VaAcc: 0.1148, VaLoss:  4.84848	 MAP NN | Acc: 0.1428 | Loss: 4.6268
 49,  0 | VaAcc: 0.1492, VaLoss:  4.50155	 MAP NN | Acc: 0.1796 | Loss: 4.5564
 50,  0 | VaAcc: 0.1012, VaLoss:  5.00843	 MAP NN | Acc: 0.1356 | Loss: 4.6171
 51,  0 | VaAcc: 0.1088, VaLoss:  4.89079	 MAP NN | Acc: 0.1480 | Loss: 4.8060
 52,  0 | VaAcc: 0.0844, VaLoss:  5.30656	 MAP NN | Acc: 0.1260 | Loss: 4.8757
 53,  0 | VaAcc: 0.1416, VaLoss:  4.63858	 MAP NN | Acc: 0.1404 | Loss: 5.0745
 54,  0 | VaAcc: 0.0924, VaLoss:  5.04871	 MAP NN | Acc: 0.1600 | Loss: 4.7680
 55,  0 | VaAcc: 0.0956, VaLoss:  4.83194	 MAP NN | Acc: 0.1628 | Loss: 4.5808
 56,  0 | VaAcc: 0.1188, VaLoss:  4.65786	 MAP NN | Acc: 0.1364 | Loss: 4.6879
 57,  0 | VaAcc: 0.1168, VaLoss:  4.75085	 MAP NN | Acc: 0.1620 | Loss: 4.3919
 58,  0 | VaAcc: 0.1060, VaLoss:  5.09128	 MAP NN | Acc: 0.1608 | Loss: 4.7350
 59,  0 | VaAcc: 0.1288, VaLoss:  4.81138	 MAP NN | Acc: 0.1456 | Loss: 4.6245
 60,  0 | VaAcc: 0.1072, VaLoss:  5.05923	 MAP NN | Acc: 0.1480 | Loss: 4.3607
 61,  0 | VaAcc: 0.0968, VaLoss:  5.00296	 MAP NN | Acc: 0.1760 | Loss: 4.3729
 62,  0 | VaAcc: 0.1156, VaLoss:  4.70612	 MAP NN | Acc: 0.1800 | Loss: 4.4609
 63,  0 | VaAcc: 0.1072, VaLoss:  4.98956	 MAP NN | Acc: 0.1560 | Loss: 4.6491
 64,  0 | VaAcc: 0.1036, VaLoss:  4.78392	 MAP NN | Acc: 0.1684 | Loss: 4.4558
 65,  0 | VaAcc: 0.0984, VaLoss:  4.89350	 MAP NN | Acc: 0.1528 | Loss: 4.5643
 66,  0 | VaAcc: 0.1248, VaLoss:  4.78473	 MAP NN | Acc: 0.1760 | Loss: 4.4298
 67,  0 | VaAcc: 0.1112, VaLoss:  4.77837	 MAP NN | Acc: 0.1620 | Loss: 4.4075
 68,  0 | VaAcc: 0.1304, VaLoss:  4.77668	 MAP NN | Acc: 0.1576 | Loss: 5.0197
 69,  0 | VaAcc: 0.1072, VaLoss:  4.70507	 MAP NN | Acc: 0.1340 | Loss: 4.8560
 70,  0 | VaAcc: 0.1012, VaLoss:  4.81582	 MAP NN | Acc: 0.1740 | Loss: 4.8273
 71,  0 | VaAcc: 0.1240, VaLoss:  4.51313	 MAP NN | Acc: 0.1408 | Loss: 5.0186
 72,  0 | VaAcc: 0.0976, VaLoss:  4.92128	 MAP NN | Acc: 0.1360 | Loss: 4.5657
 73,  0 | VaAcc: 0.0980, VaLoss:  4.67646	 MAP NN | Acc: 0.1840 | Loss: 4.5486
 74,  0 | VaAcc: 0.1212, VaLoss:  4.86803	 MAP NN | Acc: 0.1560 | Loss: 4.7496
 75,  0 | VaAcc: 0.1196, VaLoss:  4.71361	 MAP NN | Acc: 0.1816 | Loss: 4.4003
 76,  0 | VaAcc: 0.1224, VaLoss:  4.60654	 MAP NN | Acc: 0.1588 | Loss: 4.5428
 77,  0 | VaAcc: 0.1220, VaLoss:  4.81156	 MAP NN | Acc: 0.1868 | Loss: 4.4481
 78,  0 | VaAcc: 0.1048, VaLoss:  4.86031	 MAP NN | Acc: 0.1588 | Loss: 4.4901
 79,  0 | VaAcc: 0.1180, VaLoss:  4.81856	 MAP NN | Acc: 0.1492 | Loss: 4.6496
 80,  0 | VaAcc: 0.1116, VaLoss:  4.85322	 MAP NN | Acc: 0.1716 | Loss: 4.6622
 81,  0 | VaAcc: 0.1076, VaLoss:  4.80291	 MAP NN | Acc: 0.1536 | Loss: 4.6428
 82,  0 | VaAcc: 0.1100, VaLoss:  4.87973	 MAP NN | Acc: 0.1640 | Loss: 4.4587
 83,  0 | VaAcc: 0.1268, VaLoss:  4.64507	 MAP NN | Acc: 0.1716 | Loss: 4.3996
 84,  0 | VaAcc: 0.1056, VaLoss:  4.73770	 MAP NN | Acc: 0.1792 | Loss: 4.2957
 85,  0 | VaAcc: 0.1072, VaLoss:  4.81159	 MAP NN | Acc: 0.1832 | Loss: 4.4630
 86,  0 | VaAcc: 0.1188, VaLoss:  4.69831	 MAP NN | Acc: 0.1988 | Loss: 4.4687
 87,  0 | VaAcc: 0.1048, VaLoss:  4.90269	 MAP NN | Acc: 0.1680 | Loss: 4.6912
 88,  0 | VaAcc: 0.1164, VaLoss:  4.84419	 MAP NN | Acc: 0.1672 | Loss: 4.6210
 89,  0 | VaAcc: 0.1132, VaLoss:  4.94826	 MAP NN | Acc: 0.1692 | Loss: 4.4538
 90,  0 | VaAcc: 0.1196, VaLoss:  4.69781	 MAP NN | Acc: 0.1712 | Loss: 4.4826
 91,  0 | VaAcc: 0.0964, VaLoss:  4.79072	 MAP NN | Acc: 0.1752 | Loss: 4.4284
 92,  0 | VaAcc: 0.1276, VaLoss:  4.59713	 MAP NN | Acc: 0.1684 | Loss: 4.6456
 93,  0 | VaAcc: 0.1364, VaLoss:  4.71649	 MAP NN | Acc: 0.1672 | Loss: 4.6687
 94,  0 | VaAcc: 0.1276, VaLoss:  4.66344	 MAP NN | Acc: 0.1488 | Loss: 4.5657
 95,  0 | VaAcc: 0.1116, VaLoss:  4.96913	 MAP NN | Acc: 0.1816 | Loss: 4.4735
 96,  0 | VaAcc: 0.1140, VaLoss:  4.81534	 MAP NN | Acc: 0.1620 | Loss: 4.5377
 97,  0 | VaAcc: 0.1180, VaLoss:  4.86924	 MAP NN | Acc: 0.1640 | Loss: 4.7714
 98,  0 | VaAcc: 0.1264, VaLoss:  4.72782	 MAP NN | Acc: 0.1860 | Loss: 4.5938
 99,  0 | VaAcc: 0.1028, VaLoss:  4.71480	 MAP NN | Acc: 0.1552 | Loss: 4.8211
----------------------------
Results for va_s
Metric: acc   
 19.88 % in iteration   86
Metric: loss  
Results for va_b
Metric: elogl 
 8.158 in iteration   21
Metric: acc   
 14.92 % in iteration   49
EARLY STOP FOR te_s
 12.05 % in iteration   86
